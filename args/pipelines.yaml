# Pipeline Definitions — Simplified for Opus 4.6
#
# Old model: Chain multiple LLMs (Qwen → Gemini → Grok) for each task.
# New model: Claude handles everything. External tools only for unique data.
#
# Claude IS the pipeline now. These definitions describe workflows,
# not LLM routing. Claude reads these to know the steps.

workflows:
  stock_research:
    description: "Research a stock/asset — smart default report"
    steps:
      - tool: alpaca_mcp
        action: "Pull current price, volume, history, news"
      - tool: technical_indicators
        action: "Calculate RSI, MACD, Bollinger Bands, MAs, support/resistance"
      - tool: grok
        action: "Social sentiment from X (optional — only if user asks or situation warrants)"
      - role: claude
        action: "Synthesize into concise report with levels, signals, and plain-English take"
    notes: |
      Give a smart default. Don't ask user which report type.
      If they want more detail on something, they'll ask.
      Report should include: price action, key levels, technicals summary, verdict.

  portfolio_review:
    description: "Review current portfolio positions"
    steps:
      - tool: alpaca_mcp
        action: "Pull all positions, P&L, account info"
      - tool: technical_indicators
        action: "Run indicators on each holding"
      - role: claude
        action: "Summarize portfolio health, flag concerns, highlight opportunities"

  trading_signal:
    description: "Quick signal check on a symbol"
    steps:
      - tool: alpaca_mcp
        action: "Latest price, volume, recent bars"
      - tool: technical_indicators
        action: "RSI, MACD, Bollinger position"
      - role: claude
        action: "Bull/bear/neutral with confidence level and key levels"

# Grok is the only external LLM. Used when:
# - User explicitly asks for social sentiment
# - Researching a stock with heavy social media activity (meme stocks, etc.)
# - Claude decides X sentiment would add value to the analysis
grok_usage: on_demand

# Claude's approach:
# - Don't ask which report type — give the smart default
# - User will ask for more if they need it (fundamentals, deeper TA, sentiment, etc.)
# - Keep reports concise and actionable
